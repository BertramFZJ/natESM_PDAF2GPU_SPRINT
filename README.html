<html>
    
    <head>
        <title>natESM Sprint #16</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <style type="text/css">

            .frame1 {
                font-size: 14pt;
                font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
                background-color:rgb(243, 238, 240);
            }

            .frame2 {
                font-size: 14pt;
                font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;                
            }           

        </style>

    </head>

    <body>

        <h1 style="text-align: center; color: blue; font-size: 28pt;">Sprint #16: Performance evaluation, optimization, and strategy development for porting PDAF to GPUs</h1>

        <div class="frame1" style="padding: 10px;">
        
            This GIT repository contains modified and added during the sprint source code files of the PDAF (The Parallel Data Assimilation Framework) and
            the standalone offline assimilation program PDAF-ICONO (PDAF implementation used as assimilation method for â€¦), as well as configuration files,
            makefiles and runscripts for compiling and running PDAF-ICONO executables on the compute and gpu partitions of the Levante HPC System (DKRZ).
            The three main directories with source code files relate to three different issues:<br>

            <table style="width: 60%;", border="0" class="frame1">
                <tr>
                    <td style="width: 8%; text-align: center;">1.</td>
                    <td style="width: 32%; text-align: center;">IconO-Offline-PDAFV2.3</td>
                    <td style="text-align: left;">Porting the <code>PDAF_lestkf_analysis.F90::PDAF_lestkf_analysis</code> subroutine to GPU</td>
                </tr>
                <tr>
                    <td style="text-align: center;">2.</td>
                    <td style="text-align: center;">IconO-Offline-PDAFV2.3-SFO</td>
                    <td style="text-align: left;">
                        Porting to GPU the subroutine<br><code>PDAFomi_dim_obs_l.F90::PDAFomi_check_dist2_noniso_loop</code>,<br> 
                        which is part of the search for local observations module
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center;">3.</td>
                    <td style="text-align: center;">IconO-Offline-PDAFV2.3-CPU</td>
                    <td style="text-align: left;">
                        Linking of the module <code>mo_mem_workspaces.F90::mo_mem_workspaces</code> for allocation of temporary arrays 
                        from the heap withing <code>PDAF_lestkf_analysis.F90::PDAF_lestkf_analysis</code> subroutine</td>
                </tr>
            </table>

            <i>Note:</i> The initial commit was made by uploading already modified files.
        
        </div>

        <h2 style="text-align: center; font-size: 24pt">Workspace setup</h2>

        <div class="frame2">
        
            The workspace setup procedure includes creating a working directory and subsequently cloning three Git repositories into it:

            <ul style="list-style-type: none; padding-left: 15px; margin-top: 0;">
                <li>
                    <b>A1.</b> Create the working directory <code>{work_dir}</code> and navigate into it<br>
                    <code style="background: #f4f4f4; margin-top: 0;">
                        mkdir {work_dir} <br>
                        cd {work_dir}
                    </code>                    
                </li>

                <li>
                    <b>A2.</b> Clone the PDAF repository into the working directory and switch to branch 2.3<br>
                    <code style="background: #f4f4f4; margin-top: 0;">
                        git clone git@github.com:PDAF/PDAF.git <br>
                        cd PDAF <br>
                        git checkout PDAF_V2.3 <br>
                        cd ..
                    </code>
                </li>
                
                <li>
                    <b>A3.</b> Clone the PDAF-ICONO repository and switch to branch for-natESM<br>
                    <code style="background: #f4f4f4; margin-top: 0;">
                        git clone git@gitlab.dkrz.de:a270007/icono-pdaf.git <br>
                        cd icono-pdaf <br>
                        git checkout for-natESM <br>
                        cd ..
                    </code>
                </li>                    

                <li>
                    <b>A4.</b> Clone this repository into the working directory<br>
                    <code style="background: #f4f4f4; margin-top: 0;">
                        git clone git@github.com:BertramFZJ/natESM_PDAF2GPU_SPRINT.git                        
                    </code>
                </li>
              </ul>

        </div>

        <h2 style="text-align: center; font-size: 24pt">Compilation and launch of the standalone offline data assimilation program PDAF-ICONO with external library linking on Levante (DKRZ)</h2>

    </body> 
</html>
